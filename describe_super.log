----------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/bubbles/Desktop/Retirement_Income/dofile/describe_super.log
  log type:  text
 opened on:  22 Jun 2023, 16:15:10

. 
. global folder_path "/Users/bubbles/Desktop/Hilda" 

. 
. global data_output "$folder_path/output"

. 
. use "$data_output/all_variables.dta", clear 

. 
. compress
  variable lfp was float now byte
  variable retirement_status was float now byte
  variable retired_change was float now byte
  variable retired was float now byte
  variable p_age was float now byte
  variable changed_cpq was float now byte
  variable changed_scq was float now byte
  variable j_changed was float now byte
  variable reached_page was float now byte
  variable sixty_plus was float now byte
  variable cond_release was float now byte
  variable cond_changed was float now byte
  variable move_address was float now byte
  variable own was float now byte
  variable upgrade_financial was float now byte
  variable downgrade_financial was float now byte
  variable upgrade_physical was float now byte
  variable downgrade_physical was float now byte
  variable rent_to_own was float now byte
  variable own_to_rent was float now byte
  (25,986,900 bytes saved)

. 
. xtset id wave //set as panel 

Panel variable: id (unbalanced)
 Time variable: wave, 1 to 21, but with gaps
         Delta: 1 unit

. //using birth year and age at the June 30 to generate preservation age 
. 
. //generate event reaching preservation age 
. 
. gen event=(p_age == hgage)

. by id: egen eventwave = max(cond(event!=0, wave, .)) //record wave event took place, max ignore missing values
>  automatically 
(359,542 missing values generated)

. gen timesinceevent = wave - eventwave //relative time to event 
(359,542 missing values generated)

. 
. 
. 
. //generate event  change in access condition 
. gen event_a=(cond_changed == 1) 

. by id: egen eventwave_a = max(cond(event_a!=0, wave, .)) //record wave event took place, max ignore missing va
> lues automatically 
(360,262 missing values generated)

. gen timesince_a = wave - eventwave_a //relative time to event 
(360,262 missing values generated)

. 
. 
. ////////////////construct some more variables///////////////////////////////// 
> 
. gen super_at_retirement= super_final if retired ==1
(430,232 missing values generated)

. sort id 

. by id: egen super=max(super_at_retirement)
(393,620 missing values generated)

. xtile super_quart = super, nq(4)

. 
. //Simply looking at lfp vs age and not superannuation//
. 
. sort hgage 

. 
. by hgage: egen meanlfp = mean(lfp) //calculate mean lfp by age 

. 
. egen tagage = tag(hgage) //tag unique values  

. 
. //
. //twoway line meanlfp hgage if tagage ==1 & hgage <=80 & hgage >=20
. //
. 
. lgraph lfp hgage if hgage <=80 & hgage >=45, nomarker 

. lgraph retired hgage if hgage <=80 & hgage >=45, nomarker 

. 
.  //general graph of decline in lfp look pretty smooth. Look somewhat like it gets most steep around 55 for a b
> it then flatter again for a couple of periods then become more steep as heading towards mid 60s. 
. 
. 
. // mean lfp relative to p_age 
. 
end of do-file

. lgraph lfp timesinceevent, xline(0, lcolor(green)) nomarker ytitle(labor force participation)

. do "/var/folders/qm/3srmvfy90vv8qv2rzzs5zkq40000gn/T//SD76280.000000"

. 
. lgraph lfp timesinceevent, xline(0, lcolor(green)) nomarker ytitle(labor force participation) xlabel(-20 "" -1
> 0 "" 0 "preservation age" 10 "" 20 "")

. 
end of do-file

. do "/var/folders/qm/3srmvfy90vv8qv2rzzs5zkq40000gn/T//SD76280.000000"

. 
. lgraph lfp timesinceevent, xline(0, lcolor(green)) nomarker ytitle(labor force participation) xlabel(-20 "" -1
> 0 "" 0 "preservation age" 10 "" 20 "") xtitle("")

. 
end of do-file

. do "/var/folders/qm/3srmvfy90vv8qv2rzzs5zkq40000gn/T//SD76280.000000"

. lgraph lfp timesinceevent, xline(0, lcolor(green)) nomarker ytitle(labor force participation) xtitle("Preserva
> tion Age")

. 
end of do-file

. do "/var/folders/qm/3srmvfy90vv8qv2rzzs5zkq40000gn/T//SD76280.000000"

. 
. lgraph lfp timesinceevent, xline(0, lcolor(green)) nomarker ytitle(labor force participation) xtitle("preserva
> tion age")

. 
end of do-file

. graph export "/Users/bubbles/Desktop/Retirement_Income/writings/1.lfp.jpg", as(jpg) name("Graph") quality(90)
file /Users/bubbles/Desktop/Retirement_Income/writings/1.lfp.jpg saved as JPG format

. do "/var/folders/qm/3srmvfy90vv8qv2rzzs5zkq40000gn/T//SD76280.000000"

. 
. lgraph lfp timesinceevent super_quart, xline(0, lcolor(green)) nomarker //people with lowest quartile superannuation tend to have initially much
>  lower level of labor force participation but eventually higher rates than those with higher superannuation, probably because they tend to inclu
> de largely the self-employed group. 

. 
. graph export "/Users/bubbles/Desktop/Retirement_Income/writings/1.lfp_super.jpg", as(jpg) name("Graph") quality(90) replace
file /Users/bubbles/Desktop/Retirement_Income/writings/1.lfp_super.jpg saved as JPG format

. 
end of do-file

